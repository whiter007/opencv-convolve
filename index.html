<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>opencv.js</title>
    <link href="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="opencv.js"></script>
    <style>
        img,
        canvas {
            image-rendering: pixelated;
        }
    </style>
</head>

<body>
    <div style="padding:5% 25% 5% 10%;">
        <div>
            <label for="fileInput">上传图片：</label>
            <input type="file" id="fileInput" name="file" />
        </div>
        <div>
            <img id="imageSrc" alt="未选择图片" src="" width="50%" height="100%" />
            <canvas id="imageDest" width="50%" height="100%" image-rendering: pixelated;>
                <script type="text/javascript">
                    // 声明一个变体，显示用户上传的图片
                    let imgElement = document.getElementById("imageSrc");
                    // 声明一个元素，input标签上传的文件
                    let inputElement = document.getElementById("fileInput");
                    // 声明一个元素，显示处理后的图像
                    let outputElement = document.getElementById("imageDest");

                    // 设置这个图片变体的默认src属性
                    imgElement.src = "./08a3a5762e7edfadf09bdfe4061bea2e.png"
                    // 使用anonymous模式处理跨不会包含任何用户凭证（如cookies或HTTP认证信息）的源请求
                    imgElement.crossOrigin = '';

                    // 设置关键对象
                    const ctx = outputElement.getContext('2d');
                    // 关闭图像平滑处理
                    ctx.imageSmoothingEnabled = false;

                    // 处理图片上传事件
                    inputElement.addEventListener("change", (e) => {
                        // 将用户上传的文件赋到imgElement的src属性
                        imgElement.src = URL.createObjectURL(e.target.files[0]);
                    }, false);
                </script>
            </canvas>
        </div>
        <br>
        <p>卷积核kernel</p>
        <div class="row">
            <div class="column side" style="width: 50%;">
                <form>
                    <div class="row">
                        <div class="col">
                            <input id="input1" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input2" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input3" type="number" class="form-control" value="1">
                        </div>
                    </div>
                </form>
                <form>
                    <div class="row">
                        <div class="col">
                            <input id="input4" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input5" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input6" type="number" class="form-control" value="1">
                        </div>
                    </div>
                </form>
                <form>
                    <div class="row">
                        <div class="col">
                            <input id="input7" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input8" type="number" class="form-control" value="1">
                        </div>
                        <div class="col">
                            <input id="input9" type="number" class="form-control" value="1">
                        </div>
                    </div>
                </form>
            </div>
            <div class="column side" style="width: 50%;">
                <!-- 归一化处理的开关 -->
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="normalizeSwitch" checked>
                    <label class="form-check-label" for="normalizeSwitch">开启归一化处理</label>
                </div>
                <button onclick="img_process();" type="button" class="btn btn-primary btn-lg">更新图像</button>
            </div>
        </div>
    </div>
    <script src="image_process.js" type="text/javascript"></script>
    <script src="convolve.js" type="text/javascript"></script>
    <script>
        function getNormalizationStatus() {
            // 获取复选框元素
            var checkBox = document.getElementById('normalizeSwitch');
            // 返回复选框的选中状态
            return checkBox.checked;
        }
    </script>
</body>

</html>